<section>

<h1>Rails ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³</h1>
<h3>ç§’é€Ÿ<a href="https://github.com/284km" class="user-mention">@284km</a>
</h3>
<h5>è¡¨å‚é“.rb #25 ~ Rails ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ ~</h5>

<p><img src="../goku.jpg" alt="goku.jpg"></p>

</section>
<section>

<h1>ç§’é€Ÿ<a href="https://github.com/284km" class="user-mention">@284km</a>
</h1>
<p><img src="../goku.jpg" alt="goku.jpg"></p>

<ul>
  <li>feedforce ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
    <ul>
      <li>Ruby/Rails ä¸­å¿ƒã®ç”Ÿæ´»</li>
      <li>ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œã‚‹äºº</li>
    </ul>
  </li>
  <li>Rails Developers Meetup é‹å–¶</li>
</ul>

</section>
<section>

<h1>ä»Šæ—¥è©±ã™ã“ã¨</h1>

<ul>
  <li>
    <h2>ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³é–¢é€£ã® tips</h2>
  </li>
</ul>

</section>
<section>

<h2>View ã«æ–‡å­—åˆ—ã‚’ç›´ã«æ›¸ã</h2>

<p>æœ€åˆã¯æ¥½ã‹ã‚‚ã—ã‚Œãªã„ã€‚ã—ã‹ã—è¤‡æ•°ç®‡æ‰€ã«åŒã˜å†…å®¹ã‚’æ›¸ã„ã¦ã—ã¾ã†ã“ã¨ã‚’èª˜ç™ºã™ã‚‹ã€‚ã™ã‚‹ã¨ä¿®æ­£ãŒå¿…ç”¨ã«ãªã£ãŸæ™‚ã«ã€ç›´ã—æ¼ã‚ŒãŒç™ºç”Ÿã—ãŸã‚Šã€‚ãã‚‚ãã‚‚ã©ã® view ã«ä½•ãŒã‚ã‚‹ã®ã‹ç®¡ç†ã™ã‚‹ã®ã¯é›£ã—ã™ãã‚‹ã€‚</p>

<pre><code class="language-rb">&lt;%= "ã‚¿ã‚¤ãƒˆãƒ«ï¼š" %&gt;

ã¨ã‹

&lt;%= "ã“ã‚“ã«ã¡ã¯ã€‚ã”ç™»éŒ²ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚" %&gt;
</code></pre>

</section>
<section>

<h2>I18n ã®è¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ãŠã†</h2>

<pre><code class="language-rb"># config/locales/ja.yml
ja:
  hello: "ã“ã‚“ã«ã¡ã¯ã“ã‚“ã«ã¡ã¯"

# view
&lt;%= t(:title) %&gt;
</code></pre>

</section>
<section>

<h2>migration ã¯ commit ã™ã‚‹å‰ã« rollback ã‚‚ç¢ºèªã—ã‚ˆã†</h2>

<p>ã„ã–æˆ»ã—ãŸã„äº‹æ…‹ã«é™¥ã£ãŸæ™‚ã«æˆ»ã›ãªã„ã¨æœ€æ‚ªæ­»ã¬ã€‚ãã‚Œã«ãã†ã„ã†æ™‚ã¯äººã¯æ…Œã¦ã¦ã„ã‚‹ã€‚ä½™è£•ã®ã‚ã‚‹ã¨ãï¼ˆä½™è£•ã‚’ä½œã£ã¦ï¼‰ç¢ºèªã—ã¦ã‹ã‚‰ã‚³ãƒŸãƒƒãƒˆã™ã‚‹ã“ã¨ã§èº«ã‚’å®ˆã‚ã†ã€‚</p>

</section>
<section>

<h2>bundle update ã‚’ã©ã“ã‹ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ä¸€æ°—ã«ã‚„ã‚ã†ã¨ã™ã‚‹</h2>

<p>ä¸€æ°—ã«ã‚„ã‚‹ã¨ã€ã©ã“ãŒå¤‰ã‚ã£ãŸå½±éŸ¿ã‹åˆ¤æ–­ã™ã‚‹ã®ãŒå¤§å¤‰ã€‚ãŸã‚ã‚Œã°è²¯ã‚ãŸã ã‘ã€è¿”æ¸ˆé¡ã¯æŒ‡æ•°é–¢æ•°çš„ã«å¢—åŠ ã™ã‚‹æ„Ÿè¦šãŒã‚ã‚‹ã€‚é‡‘åˆ©ãŒé«˜ã„ã€‚</p>

</section>
<section>

<h2>default_scope</h2>

<ul>
  <li>å…¨éƒ¨ç†è§£ã—ã¦ã„ãªã„ã¨ã€æœ¬æ¥ã‚„ã‚ŠãŸã‹ã£ãŸã“ã¨ã¨ãšã‚Œã¦ã„ãŸã‚Šâ€¦</li>
  <li>unscope ç”¨ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨æ„ã™ã‚‹ã¨ã„ã†ã®ã‚‚ä¸æ¯›</li>
  <li>å¤–ã—ãŸããªã£ãŸæ™‚ã«ã‹ãªã‚Šé¢å€’
    <ul>
      <li>å¯¾è±¡ç®‡æ‰€å…¨ã¦ãŒå½±éŸ¿ç¯„å›²</li>
      <li>ä¸€æ°—ã«å…¨éƒ¨ç›´ã™ã—ã‹ãªã„</li>
      <li>ã‚„ã‚‹ãªã‚‰ã¡ã‚ƒã‚“ã¨å…¨ç®‡æ‰€ã®ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ã¦è‡¨ã‚€ã¹ã</li>
    </ul>
  </li>
</ul>

<pre><code>class User &lt; ApplicationRecord
  default_scope { where(foo: 'bar') }
end
</code></pre>

<pre><code class="language-rb">User.limit(3)
#=&gt; SELECT `users.* FROM `users` WHERE `users`.`foo` = 'bar' LIMIT3

# default_scopeã‚’ç„¡åŠ¹ã«ã—ãŸã„ã¨ãã¯ã“ã‚“ãªé¢¨ã«æ›¸ã
User.unscoped.limit(3)
#=&gt; SELECT `users.* FROM `users` 'bar' LIMIT3
</code></pre>

</section>
<section>

<h2>Rails AntiPatterns</h2>

<ul>
  <li>ç„¡æ–™ã§èª­ã‚ã‚‹</li>
  <li>ã¡ã‚‡ã£ã¨å¤ã„ã€‚Rails ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ 3 ãŒå¯¾è±¡</li>
  <li>ã ã‘ã©ä»Šèª­ã‚“ã§ã‚‚ååˆ†ã«å½¹ç«‹ã¤ã‚¨ãƒƒã‚»ãƒ³ã‚¹ãŒãŸãã•ã‚“ã€‚</li>
</ul>

<p><img src="https://user-images.githubusercontent.com/1458041/28918095-053e0df2-7883-11e7-9ac4-eb2e1e402836.png" alt="rails_antipatterns"></p>

</section>
<section>

<h2>æœ¬æ›¸ã®æœ€åˆã®æ–¹ã‚’ç´¹ä»‹ã—ã¾ã™</h2>

</section>
<section>

<p>å¤‰æ›´ã«å¼±ã„ä¾‹</p>

<pre><code>class Address &lt; ActiveRecord::Base
  belongs_to :customer
end
class Customer &lt; ActiveRecord::Base
  has_one :address
  has_many :invoices
end
class Invoice &lt; ActiveRecord::Base
  belongs_to :customer
end
</code></pre>

</section>
<section>

<p>å¤‰æ›´ã«å¼±ã„ä¾‹</p>

<p>æ¬ ç‚¹ã¯ã€ã‚¯ãƒ©ã‚¹ã«å¤šãã®å°ã•ãªãƒ©ãƒƒãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ãŒæ•£åœ¨ã—ã¦ã„ã‚‹ã“ã¨ã§ã™ã€‚<br>
å¤‰æ›´ãŒå¿…è¦ãªå ´åˆã¯ã€ã“ã‚Œã‚‰ã®ãƒ©ãƒƒãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã™ã¹ã¦ç¶­æŒã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>

<pre><code>&lt;%= @invoice.customer.name %&gt;
&lt;%= @invoice.customer.address.street %&gt;
&lt;%= @invoice.customer.address.city %&gt;
&lt;%= @invoice.customer.address.state %&gt;
&lt;%= @invoice.customer.address.zip_code %&gt;
</code></pre>

<p>ãƒ‡ãƒ¡ãƒ†ãƒ«ã®æ³•å‰‡<br>
<a href="https://ja.wikipedia.org/wiki/%E3%83%87%E3%83%A1%E3%83%86%E3%83%AB%E3%81%AE%E6%B3%95%E5%89%87">https://ja.wikipedia.org/wiki/%E3%83%87%E3%83%A1%E3%83%86%E3%83%AB%E3%81%AE%E6%B3%95%E5%89%87</a><br>
ç°¡æ½”ã«è¨€ã†ã¨ã€Œç›´æ¥ã®å‹é”ã¨ã ã‘è©±ã™ã“ã¨ã€ã¨è¦ç´„ã§ãã‚‹ã€‚</p>

</section>
<section>

<p>delegate ã‚’ã†ã¾ãä½¿ã„ã¾ã—ã‚‡ã†</p>

<pre><code>class Address &lt; ActiveRecord::Base
  belongs_to :customer
end
class Customer &lt; ActiveRecord::Base
  has_one :address
  has_many :invoices
  delegate :street, :city, :state, :zip_code, :to =&gt; :address
end
class Invoice &lt; ActiveRecord::Base
  belongs_to :customer
  delegate :name,
           :street,
           :city,
           :state,
           :zip_code,
           :to =&gt; :customer, :prefix =&gt; true
end
</code></pre>

</section>
<section>

<p>ã“ã†ãªã‚Šã¾ã™ã€‚</p>

<pre><code>&lt;%= @invoice.customer_name %&gt;
&lt;%= @invoice.customer_street %&gt;
&lt;%= @invoice.customer_city %&gt;,
&lt;%= @invoice.customer_state %&gt;
&lt;%= @invoice.customer_zip_code %&gt;
</code></pre>

</section>
<section>

<p>scope ã‚’æ´»ç”¨ã—ã‚ˆã†ã¨ã„ã†ã¯ãªã—ã€‚</p>

<p>ã“ã® View ã«æ›¸ã‹ã‚ŒãŸãƒ­ã‚¸ãƒƒã‚¯ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã§ä½•åº¦ã‚‚è¤‡è£½ã•ã‚Œã€ä¿å®ˆæ€§ã‚’ä¸‹ã’ã‚‹å•é¡Œã‚’å¼•ãèµ·ã“ã™ã¨è¨€ãˆã‚‹ã€‚</p>

<pre><code class="language-html">&lt;html&gt;
  &lt;body&gt;
    &lt;ul&gt;
      &lt;% User.find(:order =&gt; "last_name").each do |user| -%&gt;
        &lt;li&gt;&lt;%= user.last_name %&gt; &lt;%= user.first_name %&gt;&lt;/li&gt;
      &lt;% end %&gt;
    &lt;/ul&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>PHP ã§ã¯å®Ÿéš›ã« HTML ãƒšãƒ¼ã‚¸ã«ç›´æ¥ SQL ã‚’ç½®ãã“ã¨ã¯çã—ã„ã“ã¨ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚çš„ãªäº‹ãŒæ›¸ã„ã¦ã‚ã‚‹â€¦</p>

</section>
<section>

<p>Controller ã«æŒã£ã¦ãã‚‹ã¨ã€</p>

<pre><code class="language-ruby">class UsersController &lt; ApplicationController
  def index
    @users = User.order("last_name")
  end
end
</code></pre>

<p>View ã‹ã‚‰ã¯æ¶ˆãˆãŸã€‚</p>

<pre><code class="language-html">&lt;html&gt;&lt;body&gt;&lt;ul&gt;
&lt;% @users.each do |user| -%&gt;
  &lt;li&gt;&lt;%= user.last_name %&gt; &lt;%= user.first_name %&gt;&lt;/li&gt;
&lt;% end %&gt;
&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;
</code></pre>

</section>
<section>

<p>ã‚‚ã†ã²ã¨ã¤ã“ã†ã™ã‚‹ã¨ã€Model ã«åã¾ã£ãŸã€‚</p>

<pre><code>class UsersController &lt; ApplicationController
  def index
    @users = User.ordered
  end
end

class User &lt; ActiveRecord::Base
  scope :ordered, order("last_name")
end
</code></pre>

</section>
<section>

<h2>ã•ã„ã”ã«</h2>

<h3>äººé–“ãŒã‚„ã‚‰ãªãã¦ã‚‚è‰¯ã„éƒ¨åˆ†ã¯ãƒ„ãƒ¼ãƒ«ã«é ¼ã‚‹ã¨ã„ã†æ‰‹æ®µã‚‚</h3>
<h3>è€ƒãˆã‚‹ã“ã¨ã€ã‚„ã‚‹ã“ã¨æ¸›ã‚‰ã›ã‚‹éƒ¨åˆ†ã¯æ¸›ã‚‰ã—ã¦ã„ããŸã„</h3>

<ul>
  <li>
    <h3>rubocop</h3>
  </li>
  <li>
    <h3>rails_best_practices</h3>
  </li>
  <li>
    <h3>reek (ä½¿ãˆã¦ãªã„ã‘ã©ã€ä½¿ã„ã“ãªã—ãŸã„)</h3>
  </li>
</ul>

</section>
<section>

<h1>Rails Developers Meetup #4</h1>
<h1>8/24 (æœ¨)</h1>
<h1>ã¿ã‚“ãªæ¥ã¦ã­ğŸ’–</h1>

</section>
